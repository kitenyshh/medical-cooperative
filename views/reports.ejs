<%- include('layout', { 
  body: `
    <div class="reports-container">
      <h2>üìä –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</h2>

      <div class="report-section">
        <h3>üìÖ –í—ã–∑–æ–≤—ã –ø–æ –¥–∞—Ç–µ</h3>
        <input type="date" id="dateFilter" value="${date}">
        <button onclick="loadReports()">–û–±–Ω–æ–≤–∏—Ç—å</button>
        <table id="visitsTable">
          <thead>
            <tr><th>–î–∞—Ç–∞</th><th>–ö–æ–ª-–≤–æ –≤—ã–∑–æ–≤–æ–≤</th><th>–í—Ä–∞—á–∏</th></tr>
          </thead>
          <tbody>
            ${
              visitsByDate.map(row => `
                <tr>
                  <td>${row.date}</td>
                  <td>${row.count}</td>
                  <td>${row.doctors}</td>
                </tr>
              `).join('')
            }
          </tbody>
        </table>
      </div>

      <div class="report-section">
        <h3>üè• –ë–æ–ª—å–Ω—ã–µ –ø–æ –¥–∏–∞–≥–Ω–æ–∑—É</h3>
        <table>
          <thead><tr><th>–î–∏–∞–≥–Ω–æ–∑</th><th>–ö–æ–ª-–≤–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</th></tr></thead>
          <tbody>
            ${
              byDiagnosis.map(row => `
                <tr>
                  <td>${row.diagnosis}</td>
                  <td>${row.patients_count}</td>
                </tr>
              `).join('')
            }
          </tbody>
        </table>
      </div>

      <div class="report-section">
        <h3>üíä –õ–µ–∫–∞—Ä—Å—Ç–≤–∞ –∏ –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</h3>
        <table>
          <thead><tr><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ü—Ä–∏–µ–º</th><th>–î–µ–π—Å—Ç–≤–∏–µ</th><th>–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</th></tr></thead>
          <tbody>
            ${
              medicines.map(m => `
                <tr>
                  <td>${m.name}</td>
                  <td>${m.intake_method}</td>
                  <td>${m.action_description}</td>
                  <td>${m.side_effects}</td>
                </tr>
              `).join('')
            }
          </tbody>
        </table>
      </div>
    </div>
  `,
  doctor 
}) %>
